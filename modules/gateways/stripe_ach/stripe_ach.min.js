function initStripeACH(){var e,n,t,i,o=jQuery("#frmPayment");o.length&&(jQuery("#inputBankAcctType").closest("div.form-group").slideUp().remove(),jQuery("#inputBankAcctHolderName").closest("div.form-group").slideUp().remove(),jQuery("#inputBankRoutingNum").closest("div.form-group").slideUp().remove(),jQuery("#inputBankName").closest("div.form-group").slideUp().remove(),jQuery("#inputBankAcctNum").closest("div.form-group").slideUp().remove(),jQuery("#billingAddressChoice").closest("div.form-group").slideUp().remove(),e=jQuery("#btnSubmitContainer"),n=jQuery('input[name="paymethod"]:checked').val(),o.off("submit"),e.find("button").addClass("disabled").prop("disabled",!0),e.before('<div class="form-group bank-details">\n    <label for="inputBankDetails" class="col-sm-4 control-label">\n        \n    </label>\n    <div class="col-sm-6">\n        <button type="button" class="btn btn-default form-control" id="inputBankDetails">            <i class="fal fa-plus-circle"></i> Add Bank Information        </button>    </div>\n</div>'),t="#inputBankDetails",i=jQuery(t),"new"===n?(i.not(":visible")&&i.show("fast"),jQuery(document).on("click",t,handler_open)):(i.is(":visible")&&i.hide("fast"),jQuery(document).off("click",t),e.find("button").removeClass("disabled").prop("disabled",!1)),jQuery('input[name="paymethod"]').on("ifChecked",function(){i=jQuery("#inputBankDetails"),"new"===jQuery(this).val()?(i.not(":visible")&&i.show("fast"),jQuery(document).on("click",t,handler_open)):(i.is(":visible")&&i.hide("fast"),jQuery(document).on("click",t,handler_open),e.find("button").removeClass("disabled").prop("disabled",!1))}))}function stripe_ach_reset_input_to_new(){jQuery('input[name="paymethod"][value="new"]').iCheck("check"),setTimeout(function(){jQuery(".gateway-errors").slideUp()},4e3)}function handler_open(){var t=jQuery("#frmPayment"),i=jQuery(".gateway-errors").first();Plaid.create({env:plaidEnvironment,token:plaidLinkToken,selectAccount:!0,onSuccess:function(e,n){WHMCS.http.jqClient.jsonPost({url:WHMCS.utils.getRouteUrl("/stripe_ach/token/exchange"),data:{token:csrfToken,public_token:e,account_id:n.account_id},success:function(e){token=e.token,t.append(jQuery('<input type="hidden" name="remoteStorageToken">').val(token));e=jQuery("#btnSubmitContainer");jQuery("#inputBankDetails").prop("disabled",!0).addClass("disabled"),e.find("button").removeClass("disabled").prop("disabled",!1),e.find("button").click(),e.find("button").addClass("disabled").prop("disabled",!0)},warning:function(e){i.html(e),i.not(":visible")&&i.slideDown(),scrollToGatewayInputError()},fail:function(e){i.html(e),i.not(":visible")&&i.slideDown(),scrollToGatewayInputError()}})},onExit:function(e,n){null!=(e=null===e&&n&&"requires_credentials"===n.status&&!n.link_session_id?"Incorrect Plaid credentials provided. Please contact support.":e)&&(i.html(e),i.not(":visible")&&i.slideDown(),scrollToGatewayInputError())}}).open()}