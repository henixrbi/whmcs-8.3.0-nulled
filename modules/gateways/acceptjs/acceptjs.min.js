var acceptJsModalInput=!1;function validateAcceptJs(e){if("undefined"==typeof recaptchaValidationComplete||"undefined"==typeof recaptchaType||"invisible"!==recaptchaType||!1!==recaptchaValidationComplete){var a=jQuery('input[name="paymentmethod"]:checked'),t=jQuery("#frmCheckout"),r=jQuery('input[name="ccinfo"]');if("acceptjs"!==a.val()||"acceptjs"===a.val()&&"useexisting"===r.val())return!0;e.preventDefault(),t.find("#btnCompleteOrder").attr("disabled","disabled").addClass("disabled");var n={},a={},r={};r.cardNumber=jQuery("#inputCardNumber").val().replace(/\s/g,"");t=jQuery("#inputCardExpiry").payment("cardExpiryVal");r.month=t.month.toString(),1===r.month.length&&(r.month="0"+r.month),r.year=t.year,t=null,r.cardCode=jQuery("#inputCardCVV").val(),r.zip=jQuery("#inputPostcode").val();t=jQuery("#inputFirstName");return t.length&&t.val()&&(r.fullName=t.val()+" "+jQuery("#inputLastName").val()),n.cardData=r,a.clientKey=clientKey,a.apiLoginID=apiLoginId,n.authData=a,Accept.dispatchData(n,acceptJsResponseHandler),!1}e.preventDefault()}function acceptJsResponseHandler(e){var a=jQuery("#frmCheckout");if("Error"===e.messages.resultCode){for(var t="",r=0;r<e.messages.message.length;r++)t+=e.messages.message[r].text+"\n";a.find(".gateway-errors").text(t).slideDown(),scrollToGatewayInputError(),a.find("#btnCompleteOrder").removeAttr("disabled").removeClass("disabled")}else a.find(".gateway-errors").text("").slideUp(),a.append(jQuery('<input type="hidden" name="dataDescriptor">').val(e.opaqueData.dataDescriptor)),a.append(jQuery('<input type="hidden" name="dataValue">').val(e.opaqueData.dataValue)),a.off("submit",validateAcceptJs),a.find("#btnCompleteOrder").removeAttr("disabled").removeClass("disabled").click().addClass("disabled").attr("disabled","disabled")}function enable_acceptjs(){var e=jQuery("#frmCheckout"),a=e.find("#cardType");e.find("#cctype").removeAttr("name"),e.find("#inputCardNumber").removeAttr("name"),e.find("#inputCardExpiry").removeAttr("name"),e.find("#inputCardCVV").removeAttr("name"),a.length?e.find("#cardType").parents("div.col-sm-6").slideUp("fast",function(){e.find("#inputCardNumber").parents("div.col-sm-6").toggleClass("col-sm-6 col-sm-12")}):(e.find("#cctype").parents("div.new-card-info").slideUp("fast"),e.find("#cctype").parents("tr.newccinfo").slideUp("fast")),e.on("submit",validateAcceptJs)}function disable_acceptjs(){var e=jQuery("#frmCheckout"),a=e.find("#cardType");e.find("#inputCardNumber").attr("name","ccnumber"),e.find("#inputCardExpiry").attr("name","ccexpirydate"),e.find("#inputCardCVV").attr("name","cccvv"),e.find("#cctype").attr("name","cctype"),a.length?(e.find("#inputCardNumber").parents("div.col-sm-12").toggleClass("col-sm-6 col-sm-12"),e.find("#cardType").parents("div.col-sm-6").slideDown("fast")):(e.find("#cctype").parents("div.new-card-info").slideDown("fast"),e.find("#cctype").parents("tr.newccinfo").slideDown("fast")),e.off("submit",validateAcceptJs)}function validateNewCcAcceptJs(e){e.preventDefault(),jQuery("#btnSubmitNewCard").attr("disabled","disabled").addClass("disabled");var a={},t={},r={};r.cardNumber=jQuery("#inputCardNumber").val().replace(/\s/g,"");e=jQuery("#inputCardExpiry").payment("cardExpiryVal");return r.month=e.month.toString(),1===r.month.length&&(r.month="0"+r.month),r.year=e.year,e=null,r.cardCode=jQuery("#inputCardCvc").val(),a.cardData=r,t.clientKey=clientKey,t.apiLoginID=apiLoginId,a.authData=t,Accept.dispatchData(a,acceptJsNewCcResponseHandler),!1}function acceptJsNewCcResponseHandler(e){var a=jQuery(".frm-credit-card-input");if("Error"===e.messages.resultCode){for(var t="",r=0;r<e.messages.message.length;r++)t+=e.messages.message[r].text+"\n";a.find(".gateway-errors,.assisted-cc-input-feedback").text(t).slideDown(),scrollToGatewayInputError(),jQuery("#btnSubmitNewCard").removeAttr("disabled").removeClass("disabled")}else a.find(".gateway-errors,.assisted-cc-input-feedback").text("").slideUp(),a.append(jQuery('<input type="hidden" name="dataDescriptor">').val(e.opaqueData.dataDescriptor)),a.append(jQuery('<input type="hidden" name="dataValue">').val(e.opaqueData.dataValue)),a.off("submit",validateNewCcAcceptJs),a.append('<input type="submit" id="hiddenSubmit" name="submit" value="Save Changes" style="display: none">'),jQuery("#hiddenSubmit").click()}function enable_payment_acceptjs(){var e=jQuery("#frmPayment");e.find("#cctype").removeAttr("name").parents("div.form-group").remove(),e.find("#inputCardNumber").removeAttr("name").payment("formatCardNumber"),e.find("#inputCardExpiry").removeAttr("name"),e.find("#inputCardExpiryYear").removeAttr("name"),e.find("#inputCardCvv").removeAttr("name").payment("formatCardCVC").parents("div.form-group").show("fast"),e.on("submit",validatePaymentAcceptJs)}function validatePaymentAcceptJs(e){e.preventDefault(),jQuery("#btnSubmit").attr("disabled","disabled").addClass("disabled");var a={},t={},r={};r.cardNumber=jQuery("#inputCardNumber").val().replace(/\s/g,"");e=jQuery("#inputCardExpiry").payment("cardExpiryVal");return r.month=e.month.toString(),1===r.month.length&&(r.month="0"+r.month),r.year=e.year,r.cardCode=jQuery("#inputCardCvv").val(),a.cardData=r,t.clientKey=clientKey,t.apiLoginID=apiLoginId,a.authData=t,Accept.dispatchData(a,acceptJsPaymentResponseHandler),!1}function acceptJsPaymentResponseHandler(e){var a=jQuery("#frmPayment");if("Error"===e.messages.resultCode){for(var t="",r=0;r<e.messages.message.length;r++)t+=e.messages.message[r].text+"\n";a.find(".gateway-errors").text(t).slideDown(),scrollToGatewayInputError(),jQuery("#btnSubmit").removeAttr("disabled").removeClass("disabled").find("span").toggle()}else a.find(".gateway-errors").text("").slideUp(),a.append(jQuery('<input type="hidden" name="dataDescriptor">').val(e.opaqueData.dataDescriptor)),a.append(jQuery('<input type="hidden" name="dataValue">').val(e.opaqueData.dataValue)),a.off("submit",validatePaymentAcceptJs),a.find("#btnSubmit").removeAttr("disabled").removeClass("disabled").click().addClass("disabled").attr("disabled","disabled")}function validateAdminAcceptJs(e){var a=jQuery("#frmCreditCardDetails");e.preventDefault(),a.find('button[type="submit"],input[type="submit"]').prop("disabled",!0).addClass("disabled").find("span").toggle();var t={},r={},n={};n.cardNumber=jQuery("#inputCardNumber").val().replace(/\s/g,"");e=jQuery("#inputCardExpiry").payment("cardExpiryVal"),a=e.month.toString();return 1===a.length&&(a="0"+a),n.month=a,n.year=e.year,e=null,n.cardCode=jQuery("#cardcvv").val(),t.cardData=n,r.clientKey=clientKey,r.apiLoginID=apiLoginId,t.authData=r,Accept.dispatchData(t,acceptJsAdminResponseHandler),!1}function acceptJsAdminResponseHandler(e){var a=jQuery("#frmCreditCardDetails");if("Error"===e.messages.resultCode){for(var t="",r=0;r<e.messages.message.length;r++)t+=e.messages.message[r].text+"\n";a.find(".gateway-errors").text(t).slideUp(),scrollToGatewayInputError(),a.find("#btnSaveChanges").removeAttr("disabled").removeClass("disabled")}else{a.find(".gateway-errors").text("").slideUp(),a.append(jQuery('<input type="hidden" name="dataDescriptor">').val(e.opaqueData.dataDescriptor)),a.append(jQuery('<input type="hidden" name="dataValue">').val(e.opaqueData.dataValue)),a.append('<input type="submit" id="hiddenSubmit" name="submit" value="Save Changes" style="display: none">'),a.off("submit",validateAdminAcceptJs);a=jQuery("#hiddenSubmit");acceptJsModalInput&&((a=jQuery("#modalAjaxFooter").find("#btnSave")).removeClass("disabled"),jQuery("#modalAjax .loader").fadeOut(),a.off("click",validateAdminAcceptJs),a.on("click",submitIdAjaxModalClickEvent)),a.click()}}function enable_acceptjs_card_input(){var e=jQuery(".frm-credit-card-input");e.find("#inputCardNumber").removeAttr("name").payment("formatCardNumber"),e.find("#inputCardExpiry").removeAttr("name").payment("formatCardExpiry"),e.find("#inputCardCvc").removeAttr("name").payment("formatCardCVC"),e.find('button[type="submit"]').removeAttr("name"),e.on("submit",validateNewCcAcceptJs)}function disable_acceptjs_card_input(){var e=jQuery(".frm-credit-card-input");e.find("#inputCardNumber").attr("name","ccnumber").payment("formatCardNumber"),e.find("#inputCardExpiry").removeAttr("name","ccexpiry").payment("formatCardExpiry"),e.find("#inputCardCvc").removeAttr("name","cardcvv").payment("formatCardCVC"),e.find('button[type="submit"]').attr("name","submit"),e.off("submit",validateNewCcAcceptJs)}jQuery(document).ready(function(){var e,a,t,r=jQuery('input[name="paymentmethod"]'),n=jQuery("#frmCheckout"),i=jQuery(".frm-credit-card-input"),d=jQuery("#frmPayment"),s=jQuery("#frmCreditCardDetails");r.length&&!i.length?(e=jQuery('input[name="ccinfo"]'),a=jQuery('input[name="ccinfo"]:checked'),"acceptjs"===(t=jQuery('input[name="paymentmethod"]:checked').val())&&(enable_acceptjs(),"new"!==e.val()&&n.off("submit",validateAcceptJs)),r.on("ifChecked change",function(){"acceptjs"===(t=jQuery(this).val())?(enable_acceptjs(),"new"!==a.val()&&n.off("submit",validateAcceptJs)):disable_acceptjs()}),jQuery(document).on("ifChecked",'input[name="ccinfo"]',function(){n.off("submit",validateAcceptJs),"acceptjs"===t&&"useexisting"!==jQuery('input[name="ccinfo"]:checked').val()&&n.on("submit",validateAcceptJs)})):i.length?("acceptjs"===jQuery('input[name="type"]:checked').data("gateway")&&enable_acceptjs_card_input(),jQuery('input[name="type"]').on("ifChecked change",function(){("acceptjs"===jQuery(this).data("gateway")?enable_acceptjs_card_input:disable_acceptjs_card_input)()})):d.length?(d.off("submit",validateCreditCardInput),"new"===jQuery('input[name="ccinfo"]:checked').val()?enable_payment_acceptjs():d.find("#inputCardCvv").parents("div.form-group").hide("fast"),jQuery('input[name="ccinfo"]').on("ifChecked change",function(){"new"===jQuery(this).val()?enable_payment_acceptjs():(d.find("#inputCardCvv").parents("div.form-group").hide("fast"),d.off("submit",validatePaymentAcceptJs))})):s.length&&(s.find("#cctype").removeAttr("name").parents("tr#rowCardType").hide("fast"),s.find("#inputCardNumber").removeAttr("name"),s.find("#inputCardExpiry").removeAttr("name"),s.find("#cardcvv").removeAttr("name"),jQuery("#containerStorageInputControl")?((i=jQuery("#modalAjaxFooter").find("#btnSave")).removeAttr("name"),i.off(),i.on("click",validateAdminAcceptJs),acceptJsModalInput=!0):(s.find("#btnSaveChanges").removeAttr("name"),s.on("submit",validateAdminAcceptJs)))});