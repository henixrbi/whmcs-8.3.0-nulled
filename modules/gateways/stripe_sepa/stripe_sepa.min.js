function initStripeSEPA(){var e,i,t,n,a=jQuery("#frmPayment");a.length&&(jQuery("#inputBankAcctType").closest("div.form-group").slideUp().remove(),jQuery("#inputBankRoutingNum").closest("div.form-group").slideUp().remove(),jQuery("#inputBankName").closest("div.form-group").slideUp().remove(),jQuery("#inputBankAcctNum").closest("div.form-group").slideUp().remove(),jQuery("#billingAddressChoice").closest("div.form-group").slideUp().remove(),jQuery("#inputDescriptionContainer").before('<div id="ibanElementContainer" class="form-group bank-details">\n    <label for="ibanElement" class="col-sm-4 control-label">\n'+lang.iban+'    </label>\n<div class="col-sm-7">    <div class="input-inline form-control" id="ibanElement">\n</div>    </div>\n</div><div id="mandateAcceptanceContainer" class="form-group bank-details">\n    <div class="alert alert-info" id="mandateAcceptance">\n'+lang.mandate_acceptance+"    </div>\n</div>"),e=jQuery('input[name="paymethod"]:checked').val(),i=jQuery("#ibanElementContainer"),t=jQuery("#mandateAcceptanceContainer"),n=jQuery("#inputBankAcctHolderName").closest("div.form-group"),iban.mount("#ibanElement"),a.off("submit"),iban.off("change"),"new"===e?(i.not(":visible")&&(i.show("fast"),iban.on("change",stripe_sepa_iban_change_event),a.on("submit.stripe_sepa",stripe_sepa_form_submit)),t.not(":visible")&&t.show("fast"),n.not(":visible")&&n.show("fast")):(i.is(":visible")&&i.hide("fast"),t.is(":visible")&&t.hide("fast"),n.is(":visible")&&n.hide("fast")),jQuery('input[name="paymethod"]').on("ifChecked",function(){i=jQuery("#ibanElementContainer"),t=jQuery("#mandateAcceptanceContainer"),n=jQuery("#inputBankAcctHolderName").closest("div.form-group"),"new"===jQuery(this).val()?(i.not(":visible")&&(i.show("fast"),iban.on("change",stripe_sepa_iban_change_event),a.on("submit.stripe_sepa",stripe_sepa_form_submit)),t.not(":visible")&&t.show("fast"),n.not(":visible")&&n.show("fast")):(i.is(":visible")&&(i.hide("fast"),iban.off("change"),a.off("submit.stripe_sepa")),t.is(":visible")&&t.hide("fast"),n.is(":visible")&&n.hide("fast"))}))}function stripe_sepa_iban_change_event(e){var i=jQuery(".gateway-errors").first(),t=i.closest("form");e.error&&e.error.message.length?(i.html(e.error.message),i.not(":visible")&&i.slideDown(),t.find('button[type="submit"]').prop("disabled",!1).removeClass("disabled").find("span").toggle(),scrollToGatewayInputError()):i.is(":visible")&&i.slideUp()}function stripe_sepa_form_submit(e){var t=jQuery("#btnSubmit").addClass("disabled").prop("disabled",!0);e.preventDefault();e={type:"sepa_debit",currency:"eur",owner:{name:jQuery("#inputBankAcctHolderName").val(),email:clientEmail},mandate:{notification_method:"email"}};stripe.createSource(iban,e).then(function(e){var i=jQuery(".gateway-errors").first();e.error&&e.error.message.length?(i.html(e.error.message),i.not(":visible")&&(i.slideDown(),t.removeClass("disabled").prop("disabled",!1))):(i.slideUp(),stripeSourceHandler(e.source))})}function stripeSourceHandler(e){var i=document.getElementById("frmPayment"),t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name","remoteStorageToken"),t.setAttribute("value",e.id),i.appendChild(t),i.submit()}